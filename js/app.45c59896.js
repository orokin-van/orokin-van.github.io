(function(t){function e(e){for(var o,n,a=e[0],l=e[1],c=e[2],d=0,u=[];d<a.length;d++)n=a[d],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&u.push(s[n][0]),s[n]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);m&&m(e);while(u.length)u.shift()();return r.push.apply(r,c||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],o=!0,a=1;a<i.length;a++){var l=i[a];0!==s[l]&&(o=!1)}o&&(r.splice(e--,1),t=n(n.s=i[0]))}return t}var o={},s={app:0},r=[];function n(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=o,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var m=l;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"50ea":function(t,e,i){"use strict";i("7235")},"56d7":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("Home")],1)},s=[],r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home-main"},[e("div",{staticClass:"top-main"},[e("section",{staticClass:"top-wrapper"},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[e("div",{staticClass:"item"},[e("div",{staticClass:"item-title"},[t._v(t._s(t.form.name1))]),e("el-form-item",{attrs:{label:"目标："}},[e("el-input-number",{attrs:{size:"medium",controls:!1,min:0},model:{value:t.form.orientation1,callback:function(e){t.$set(t.form,"orientation1",e)},expression:"form.orientation1"}})],1),e("el-form-item",{attrs:{label:"已完成："}},[e("el-input-number",{attrs:{size:"medium",controls:!1,min:0},model:{value:t.form.orientation2,callback:function(e){t.$set(t.form,"orientation2",e)},expression:"form.orientation2"}})],1)],1),e("div",{staticClass:"item"},[e("div",{staticClass:"item-title"},[t._v(t._s(t.form.name2))]),e("el-form-item",{attrs:{label:"目标："}},[e("el-input-number",{attrs:{size:"medium",controls:!1,min:0},model:{value:t.form.statistics1,callback:function(e){t.$set(t.form,"statistics1",e)},expression:"form.statistics1"}})],1),e("el-form-item",{attrs:{label:"已完成："}},[e("el-input-number",{attrs:{size:"medium",controls:!1,min:0},model:{value:t.form.statistics2,callback:function(e){t.$set(t.form,"statistics2",e)},expression:"form.statistics2"}})],1)],1),e("div",{staticClass:"item"},[e("div",{staticClass:"item-title"},[t._v(t._s(t.form.name3))]),e("el-form-item",{attrs:{label:"目标："}},[e("el-input-number",{attrs:{size:"medium",controls:!1,min:0},model:{value:t.form.customer1,callback:function(e){t.$set(t.form,"customer1",e)},expression:"form.customer1"}})],1),e("el-form-item",{attrs:{label:"已完成："}},[e("el-input-number",{attrs:{size:"medium",controls:!1,min:0},model:{value:t.form.customer2,callback:function(e){t.$set(t.form,"customer2",e)},expression:"form.customer2"}})],1)],1)]),e("div",[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.init}},[t._v("生成图表")]),e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.downImage}},[t._v("下载图片")]),e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.checkDetail}},[t._v("查看明细")])],1)],1),t._m(0)]),e("el-dialog",{staticClass:"table-dialog-box",attrs:{title:"明细详情",width:"1100px",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-table",{attrs:{data:t.listData,border:"","span-method":t.objectSpanMethod,"row-class-name":t.tableRowClassName}},[e("el-table-column",{attrs:{label:"领先指标",width:"222"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-input",{attrs:{placeholder:""},model:{value:i.row.name,callback:function(e){t.$set(i.row,"name",e)},expression:"scope.row.name"}})]}}])}),e("el-table-column",{attrs:{label:"目标",width:"111"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-input-number",{attrs:{controls:!1,min:0},model:{value:i.row.mark,callback:function(e){t.$set(i.row,"mark",e)},expression:"scope.row.mark"}})]}}])}),e("el-table-column",{attrs:{label:"已完成",width:"111"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-input-number",{attrs:{controls:!1,min:0},model:{value:i.row.finsh,callback:function(e){t.$set(i.row,"finsh",e)},expression:"scope.row.finsh"}})]}}])}),e("el-table-column",{attrs:{label:"得分",width:"111"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-input-number",{attrs:{controls:!1,min:0},on:{blur:function(e){return t.changeNumber(i.row)}},model:{value:i.row.score,callback:function(e){t.$set(i.row,"score",e)},expression:"scope.row.score"}})]}}])}),e("el-table-column",{attrs:{label:"行为"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"cell-behavior"},[e("el-input",{attrs:{placeholder:""},model:{value:i.row.behavior,callback:function(e){t.$set(i.row,"behavior",e)},expression:"scope.row.behavior"}}),t.shoIcon(i.row.id)?e("i",{staticClass:"el-icon-close",on:{click:function(e){return t.delRow(i.$index)}}}):t._e()],1)]}}])}),e("el-table-column",{attrs:{label:"操作",width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{staticClass:"new-beha",on:{click:function(e){return t.newRow(i.row,i.$index)}}},[t._v("新增")])]}}])})],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"medium"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.submitForm}},[t._v("确定")]),e("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.downExcel}},[t._v("导出Excel")])],1)],1)],1)},n=[function(){var t=this,e=t._self._c;return e("div",[e("div",{attrs:{id:"main"}})])}];i("b7ef"),i("13d5");function a(t){return 1===t.length?t[0]:t.reduce((t,e)=>{let i=Math.max(t,e),o=i;while(o%t!==0||o%e!==0)o+=i;return o})}var l={data(){return{minComg:1,maxComg:1,myChart:null,dialogVisible:!1,borderColor:["green","blue","red"],barColor:["#91cc75","#5470c6","#ee6666"],form:{name1:"当月已完成目标",name2:"提供统计数据、分析统计分析",name3:"见面客户及其信任方",orientation1:15,orientation2:16,statistics1:6,statistics2:3,customer1:15,customer2:8},listData:[{id:1,name:"当月已完成目标",mark:1,finsh:0,score:0,behavior:""},{id:2,name:"提供统计数据、分析统计分析",mark:1,finsh:0,score:0,behavior:""},{id:3,name:"见面客户及其信任方",mark:1,finsh:0,score:0,behavior:""}]}},computed:{objectSpanMethod(){return({row:t,column:e,rowIndex:i,columnIndex:o})=>{if([0,1,2,5].includes(o)){if(1===t.id){const t=this.listData.filter(t=>1===t.id).length;return 0===i?{rowspan:t,colspan:1}:{rowspan:0,colspan:0}}if(2===t.id){let t=this.listData.map(t=>t.id).indexOf(2);const e=this.listData.filter(t=>2===t.id).length;return i===t?{rowspan:e,colspan:1}:{rowspan:0,colspan:0}}{let t=this.listData.map(t=>t.id).indexOf(3);const e=this.listData.filter(t=>3===t.id).length;return i===t?{rowspan:e,colspan:1}:{rowspan:0,colspan:0}}}}},shoIcon(){return t=>{const e=this.listData.filter(e=>e.id===t).length;return e>1}}},mounted(){document.addEventListener("DOMContentLoaded",()=>{const t=document.body.clientWidth;if(t<900){const e=document.querySelector("#main");e.style.width=t-30+"px",e.style.height=1.3*t-30+"px",e.style.padding="20px 10px"}this.$nextTick(()=>{this.init()})},!1)},methods:{delRow(t){this.listData.splice(t,1)},changeNumber(t){let e=0;this.listData.forEach(i=>{i.id===t.id&&(e+=i.score)}),this.listData.forEach(i=>{i.id===t.id&&(i.finsh=e)})},newRow(t,e){const i=this.listData.filter(e=>e.id===t.id).length;this.listData.splice(i+e,0,{id:t.id,name:t.name,mark:t.mark,finsh:t.finsh,score:0,behavior:""})},tableRowClassName({row:t,rowIndex:e}){return 2!==t.id?"warning-row":""},downExcel(){this.downXLSX2(this.listData,"领先指标进度图",["领先指标","目标","已完成","得分","行为"])},setWidth(t){switch(t){case"name":return 222;case"mark":return 111;case"finsh":return 111;case"score":return 111;case"behavior":return 500}},downXLSX2(t,e,i){let o="<tr>";i.forEach(t=>{o+=`<td>${t}</td>`}),o+="</tr>",t.forEach((t,e)=>{o+="<tr>";for(let i in t)if("id"!==i)if(["name","mark","finsh"].includes(i))if(1===t.id){if(0===e){const e=this.listData.filter(t=>1===t.id).length;o+=`<td width=${this.setWidth(i)}  height="66" rowspan=${e}>${t[i]+"\t"}</td>`}}else if(2===t.id){let s=this.listData.map(t=>t.id).indexOf(2);if(e===s){const e=this.listData.filter(t=>2===t.id).length;o+=`<td width=${this.setWidth(i)}  height="66" rowspan=${e}>${t[i]+"\t"}</td>`}}else{let s=this.listData.map(t=>t.id).indexOf(3);if(e===s){const e=this.listData.filter(t=>3===t.id).length;o+=`<td width=${this.setWidth(i)}  height="66" rowspan=${e}>${t[i]+"\t"}</td>`}}else o+=`<td width=${this.setWidth(i)} height="66">${t[i]+"\t"}</td>`;o+="</tr>"});let s="Sheet1",r="data:application/vnd.ms-excel;base64,",n=`\n        <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n          <head>\n            \x3c!--[if gte mso 9]>\n            <xml>\n              <x:ExcelWorkbook>\n                <x:ExcelWorksheets>\n                  <x:ExcelWorksheet>\n                    <x:Name>${s}</x:Name>\n                    <x:WorksheetOptions>\n                      <x:DisplayGridlines/>\n                    </x:WorksheetOptions>\n                  </x:ExcelWorksheet>\n                </x:ExcelWorksheets>\n              </x:ExcelWorkbook>\n            </xml>\n            <![endif]--\x3e\n          </head>\n          <body>\n            <table>${o}</table>\n          </body>\n        </html>`;const a=document.createElement("a");a.setAttribute("href",r+this.utf8ToBase64(n)),a.setAttribute("download",e),a.click()},utf8ToBase64(t){return window.btoa(unescape(encodeURIComponent(t)))},downImage(){const t=this.myChart.getDataURL({backgroundColor:"#fff"}),e=document.createElement("a");e.style.display="none",e.download="领先指标进度图.png",e.href=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)},checkDetail(){this.dialogVisible=!0;const t=JSON.parse(sessionStorage.getItem("listJson"))||[];if(t.length>0&&t.length!==this.listData.length)return void(this.listData=t);let e=0,i=0,o=0;t.forEach(t=>{1===t.id?e+=t.score:2===t.id?i+=t.score:o+=t.score}),this.listData.forEach(t=>{1===t.id?(t.name=this.form.name1,t.mark=this.form.orientation1,t.finsh=e||this.form.orientation2):2===t.id?(t.name=this.form.name2,t.mark=this.form.statistics1,t.finsh=i||this.form.statistics2):(t.name=this.form.name3,t.mark=this.form.customer1,t.finsh=o||this.form.customer2)})},submitForm(){this.listData.forEach(t=>{1===t.id?(this.form.name1=t.name,this.form.orientation1=t.mark,this.form.orientation2=t.finsh):2===t.id?(this.form.name2=t.name,this.form.statistics1=t.mark,this.form.statistics2=t.finsh):(this.form.name3=t.name,this.form.customer1=t.mark,this.form.customer2=t.finsh)}),this.dialogVisible=!1,sessionStorage.setItem("listJson",JSON.stringify(this.listData)),this.$nextTick(()=>{this.init()})},init(){this.minComg=a([this.form.orientation1,this.form.customer1,this.form.statistics1]);const t=[{name:"当月已完成目标",total:this.minComg,total2:this.form.orientation1,value:this.tranformLCM(this.form.orientation1,this.form.orientation2),value2:this.form.orientation2},{name:"提供统计数据、分析统计分析",total:this.minComg,total2:this.form.statistics1,value:this.tranformLCM(this.form.statistics1,this.form.statistics2),value2:this.form.statistics2},{name:"见面客户及其信任方",total:this.minComg,total2:this.form.customer1,value:this.tranformLCM(this.form.customer1,this.form.customer2),value2:this.form.customer2}];this.initChart(t)},initChart(t=[]){const e=t[0].total;this.myChart=echarts.init(document.getElementById("main"));const i=t.map((t,e)=>({type:"bar",name:t.name,data:[t],barWidth:"28%",roundCap:!0,showBackground:!0,coordinateSystem:"polar",backgroundStyle:{color:"rgba(89, 113, 126, 0.2)"},itemStyle:{borderColor:this.borderColor[e],opacity:.9,borderWidth:2,color:t=>this.setColor(t)}})),o={color:this.barColor,title:{text:"领先指标进度图",top:"top",left:"right",textStyle:{fontSize:28}},angleAxis:{max:e,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},radiusAxis:{type:"category",z:10,axisLine:{show:!0,lineStyle:{color:"#000",width:3}},axisTick:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},polar:{center:["55%","55%"],radius:["12%","75%"]},tooltip:{show:!0,formatter:t=>`${t.name}<br/>目标：${t.data.total2}<br/>已完成：${t.data.value2}<br/>`},legend:{show:!0,icon:"circle",top:0,left:0,orient:"vertical",itemWidth:20,itemHeight:20,data:t.map(t=>t.name)},series:i};this.myChart.setOption(o)},setColor(t){return t.value>t.data.total?0===t.seriesIndex?new echarts.graphic.LinearGradient(1,0,0,0,[{offset:0,color:"rgba(145,204,117,0.3)"},{offset:1,color:"#91cc75"}]):1===t.seriesIndex?new echarts.graphic.LinearGradient(1,0,0,0,[{offset:0,color:"rgba(84,112,198,0.5)"},{offset:1,color:"#5470c6"}]):new echarts.graphic.LinearGradient(1,0,0,0,[{offset:0,color:"rgba(238,102,102,0.3)"},{offset:1,color:"#ee6666"}]):this.barColor[t.seriesIndex]},tranformLCM(t,e){return this.maxComg=this.minComg/t,e*this.maxComg}}},c=l,m=(i("50ea"),i("2877")),d=Object(m["a"])(c,r,n,!1,null,null,null),u=d.exports,h={name:"App",components:{Home:u}},f=h,p=Object(m["a"])(f,o,s,!1,null,null,null),b=p.exports;Vue.config.productionTip=!1,new Vue({render:t=>t(b)}).$mount("#app")},7235:function(t,e,i){}});